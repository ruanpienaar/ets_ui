%% -*- mode: erlang;erlang-indent-level: 4;indent-tabs-mode: nil -*-
%% ex: ts=4 sw=4 ft=erlang et
{deps, [
    {cowboy, {git, "https://github.com/ninenines/cowboy", {tag, "2.6.1"}}},
    {jsx, {git, "https://github.com/talentdeficit/jsx", {tag, "v2.9.0"}}}
]}.

{plugins, [
   {coveralls, {git, "https://github.com/markusn/coveralls-erl", "master"}}
   % Comment out below if on 17, seems to crash for me.
   % ,rebar3_proper
]}.

{cover_enabled, true}.
{cover_export_enabled, true}.
{coveralls_coverdata, "_build/test/cover/*.coverdata"}. % or a list of files
{coveralls_service_name , "travis-ci"}.
{cover_excl_mods, [ets_ui_app, ets_ui_sup]}.

% Comment out below if on 17, seems to crash for me.
{profiles,
    [{test, [
        {deps, [
        	{proper, "1.2.0"},
        	recon,
        	{erlang_testing, {git, "https://github.com/ruanpienaar/erlang_testing", {branch, "master"}}},
        	{coveralls, {git, "https://github.com/markusn/coveralls-erl", {branch, "master"}}}
        ]}
    ]}]
}.

{dialyzer, [
    {warnings, [
        % underspecs, no_return
        no_return
        ,no_unused
        ,no_improper_lists
        ,no_fun_app
        ,no_match
        ,no_opaque
        ,no_fail_call
        ,no_contracts
        ,no_behaviours
        ,no_undefined_callbacks
        ,unmatched_returns
        ,error_handling
        % ,race_conditions
        % ,overspecs
        % ,underspecs
        ,specdiffs
    ]},
    {get_warnings, true},
    {plt_apps, top_level_deps}, % top_level_deps | all_deps
    {plt_extra_apps, [ets_ui]},
    {plt_location, local}, % local | "/my/file/name"
    {plt_prefix, "rebar3"},
    {base_plt_apps, []},
    {exclude_apps, [
        kernel,
        stdlib
    ]},
    {base_plt_location, global}, % global | "/my/file/name"
    {base_plt_prefix, "rebar3"}
]}.


{base_dir, "_build"}.
{deps_dir, "lib"}.
{root_dir, "."}.
{checkouts_dir, "_checkouts"}.
{plugins_dir, "plugins"}.
{project_app_dirs, ["apps/*", "lib/*", "."]}.
{src_dirs, ["src"]}.

{eunit_opts, [
        {report, {eunit_progress, [colored, profile]}}
]}.

%% == Releases ==

{relx, [{release, { ets_ui_release, "0.0.1"},
         [
            jsx,
            cowboy,
            ets_ui
         ]},
        {dev_mode, true},
        {include_erts, false},
        {extended_start_script, true},
        {vm_args, "config/vm.args"},
        {sys_config, "config/sys.config"}
       ]
}.

%% == Shell ==

{shell, [
	{apps, [ ets_ui ]},
	{sys_config, "config/sys.config"}
	]
}.

%% == xref ==

{xref_warnings, true}.

{xref_checks, [ undefined_function_calls,
                undefined_functions,
                locals_not_used,
                % exports_not_used,
                deprecated_function_calls,
                deprecated_functions
              ]}.